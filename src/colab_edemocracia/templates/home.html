{% extends "base.html" %}
{% load staticfiles %}

{% block title %}E-Democracia{% endblock %}

{% block main %}

  {% if not user.is_authenticated %}
    {% include "login.html" %}
  {% endif %}

  <section class="section section--wikilegis">
    <div class="row expanded">
      <div class="section__info section__block columns small-12 large-3">
        <a href="/wikilegis"><img class="section__logo" src="{% static 'img/logo-wikilegis.svg' %}"></a>
        <p class="section__text">
          Edite e aprimore projetos de lei artigo por artigo.
        </p>
      </div>

      <div class="section__block columns small-12 large-9">
        <div class="section__content">
          <h1 class="section__title"><a class="section__link" href="wikilegis" title="Veja todos os projetos">Projetos de Lei</a></h1>
          <div class="container container--card-list">
            <ul class="card-list">
            {% for bill in wikilegis_data %}
              <li class="info-card info-card--wikilegis">
                <div class="info-card__header">
                  <div class="info-card__icon"><i class="icon icon-{{bill.theme}}"></i></div>
                  <a href="{{bill.get_url}}">
                    <h2 class="info-card__title">{{bill.title|truncatechars:40}}</h2>
                  </a>
                </div>
                <p class="info-card__text">
                  {{bill.description|truncatechars:160}}
                </p>
                <div class="info-card__footer">
                  <div class="card-stats">
                    <div class="card-stats__name">Propostas</div>
                    <div class="card-stats__value">{{bill.get_total_proposals}}</div>
                  </div>

                  <div class="card-stats">
                    <div class="card-stats__name">Em:</div>
                    <div class="card-stats__value">{{bill.modified|date:"d/m/Y"}}</div>
                  </div>
                </div>
              </li>
            {% endfor %}
            </ul>
          </div>
        </div>
      </div>
    </div>
  </section>

  <section class="section section--discourse">
    <div class="row expanded">
      <div class="section__info section__block columns small-12 large-3">
        <a href="/discourse"><img class="section__logo" src="{% static 'img/logo-discussao.png' %}"></a>
        <p class="section__text">
          Dê sua opinião sobre os assuntos que afetam a sua vida, discutindo soluções com outros cidadãos e os deputados.
        </p>
      </div>

      <div class="section__block columns small-12 large-9">
        <div class="section__content">
          <h1 class="section__title"><a class="section__link" href="/discourse" title="Veja todas as discussões">Discussões</a></h1>
          <div class="container container--card-list">
            <ul class="card-list">
              {% for topic in discourse_data %}
                <li class="info-card info-card--discourse">
                  <div class="info-card__header info-card__header--{{topic.category.slug}}">
                    <div class="info-card__icon"><i class="icon icon-{{topic.category.slug}}"></i></div>
                    <h2 class="info-card__title">{{topic.category.name}}</h2>
                  </div>
                  <p class="info-card__text">
                    <a href="{{topic.get_url}}">{{topic.title}}</a>
                  </p>
                  <div class="info-card__footer">
                    <div class="card-stats">
                      <div class="card-stats__name">Respostas</div>
                      <div class="card-stats__value">{{topic.posts_count}}</div>
                    </div>

                    <div class="card-stats">
                      <div class="card-stats__name">Visualizações</div>
                      <div class="card-stats__value">{{topic.views}}</div>
                    </div>

                    <div class="card-stats">
                      <div class="card-stats__name">Criado em</div>
                      <div class="card-stats__value">{{topic.last_posted_at|date:"b/Y"}}</div>
                    </div>
                  </div>
                </li>
              {% endfor %}
            </ul>
          </div>
        </div>
      </div>
    </div>
  </section>

{% endblock main %}
